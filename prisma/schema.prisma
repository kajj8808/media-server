// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id             Int             @id @default(autoincrement())
  email          String          @unique
  password       String
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
  viewedEpisodes ViewedEpisode[]
}

model Series {
  id           Int       @id @default(autoincrement())
  title        String
  description  String    @db.Text
  coverImage   String
  previewVideo String?
  poster       String
  logo         String
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  seasons      Season[]
  Episode      Episode[]
}

model Season {
  id        Int       @id @default(autoincrement())
  number    Int
  name      String
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  seriesId  Int
  series    Series    @relation(fields: [seriesId], references: [id])
  episodes  Episode[]
}

model Episode {
  id             Int             @id @default(autoincrement())
  title          String
  description    String          @db.Text
  videoId        String
  subtitleId     String?
  runtime        Int
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
  seasonId       Int
  seriesId       Int
  episodeNumber  Int
  season         Season          @relation(fields: [seasonId], references: [id])
  series         Series          @relation(fields: [seriesId], references: [id])
  viewedEpisodes ViewedEpisode[]
}

model ViewedEpisode {
  id        Int      @id @default(autoincrement())
  viewed    Boolean
  progress  Int
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  userId    Int
  user      User     @relation(fields: [userId], references: [id])
  episodeId Int
  episode   Episode  @relation(fields: [episodeId], references: [id])
}
